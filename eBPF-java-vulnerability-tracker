// compile.sh - Build script for Java vulnerability tracker
// Usage: ./compile.sh

#!/bin/bash

echo "Building Java vulnerability tracker..."

# Compile BPF program
clang -O2 -g -target bpf -c bpf_program.c -o bpf_program.o || exit 1
echo "[1/3] BPF program compiled successfully"

# Generate BPF skeleton header
bpftool gen skeleton bpf_program.c > bpf_skel.h || exit 1
echo "[2/3] BPF skeleton header generated"

# Compile user-space program
clang -O2 -g -Wall main.c -lelf -lbpf -ljson-c -o java-vuln-tracker || exit 1
echo "[3/3] User-space program compiled successfully"

echo "Build completed. Run with:"
echo "  sudo ./java-vuln-tracker -p <JAVA_PID> -V vulns.json"

chmod +x java-vuln-tracker
